{% extends "base.html" %}

{% block title %}{{ home.title }}{% endblock %}

{% block content %}
    {# Home Section #}
    <section id="home">
        <h1>{{ home.title }}</h1>
        <p>{{ home.subtitle }}</p>
        <a href="#{{ home.button_url_key }}">{{ home.button_text }}</a>
    </section>

    {# About Section #}
    <section id="about">
        <h2>{{ about.title }}</h2>
        <p>{{ about.intro }}</p>
        <p>{{ about.details }}</p>
        {# Assuming your CV is in the static folder #}
        <a href="{{ url_for('static', filename=about.cv_filename) }}" download>{{ about.cv_button }}</a>
    </section>

    {# Education Section #}
    <section id="education">
        <h2>{% if lang == 'en' %}Education{% else %}Educación{% endif %}</h2>
        <div class="education-container">
            {% for item in education %}
            <div class="education-item">
                <img src="{{ url_for('static', filename=item.institution_logo) }}" alt="{{ item.institution }}" style="max-width: 100px;">
                <h4>{{ item.degree }}</h4>
                <h5><a href="{{ item.institution_url }}" target="_blank">{{ item.institution }}</a> ({{ item.start_year }} - {{ item.end_year }})</h5>
                <p><em>{{ item.location }}</em></p>
                <p>{{ item.description }}</p>
            </div>
            {% endfor %}
        </div>
    </section>
    
    {# Work Experience Section #}
    <section id="experience">
        <h2>{% if lang == 'en' %}Work Experience{% else %}Experiencia Laboral{% endif %}</h2>
        <div class="experience-container">
            {% for job in experience %}
            <div class="experience-item">
                <img src="{{ url_for('static', filename=job.company_logo) }}" alt="{{ job.company }}" style="max-width: 100px;">
                <h4>{{ job.role }}</h4>
                <h5><a href="{{ job.company_url }}" target="_blank">{{ job.company }}</a> ({{ job.start_date }} - {{ job.end_date }})</h5>
                <p><em>{{ job.location }}</em></p>
                <p>{{ job.description }}</p>
            </div>
            {% else %}
            <p>{% if lang == 'en' %}No work experience to display yet.{% else %}Aún no hay experiencia laboral para mostrar.{% endif %}</p>
            {% endfor %}
        </div>
    </section>

    {# Projects Section #}
    <section id="projects">
        <h2>{% if lang == 'en' %}Projects{% else %}Proyectos{% endif %}</h2>
        <div class="projects-container">
            {% for project in projects %}
            <div class="project-card" id="{{ project.id }}">
                <img src="{{ url_for('static', filename=project.image) }}" alt="{{ project.name }}" style="max-width: 300px;">
                <h3>{{ project.name }}</h3>
                <p>{{ project.description }}</p>
                <p><strong>Technologies:</strong> {{ project.technologies | join(', ') }}</p>
                {% if project.live_url %}
                    <a href="{{ project.live_url }}" target="_blank">Live Demo</a>
                {% endif %}
                <a href="{{ project.repo_url }}" target="_blank">GitHub Repo</a>
            </div>
            {% endfor %}
        </div>
    </section>
    
    {# Latest News Section #}
    <section id="news">
        <h2>{% if lang == 'en' %}Latest News{% else %}Últimas Noticias{% endif %}</h2>
        <div class="posts-container">
            {% for post in latest_posts %}
            <div class="post-summary">
                <h3><a href="{{ url_for('post', lang=lang, path=post.path.replace(lang + '/', '')) }}">{{ post.title }}</a></h3>
                <p class="post-meta">Published on {{ post.meta.date.strftime('%B %d, %Y') }}</p>
                {% if post.summary %}
                    <p>{{ post.summary }}</p>
                {% endif %}
            </div>
            {% else %}
            <p>{% if lang == 'en' %}No news yet. Check back soon!{% else %}Aún no hay noticias. ¡Vuelve pronto!{% endif %}</p>
            {% endfor %}
        </div>
        <p style="text-align: center; margin-top: 2rem;">
            <a href="{{ url_for('blog', lang=lang) }}">{% if lang == 'en' %}View All Posts{% else %}Ver Todas las Publicaciones{% endif %}</a>
        </p>
    </section>

    {# Contact Section #}
    <section id="contact">
        <h2>{% if lang == 'en' %}Contact Me{% else %}Contáctame{% endif %}</h2>
        
        {# Flash messages for form submission status #}
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="flash-messages">
            {% for category, message in messages %}
              <div class="alert-{{ category }}">{{ message }}</div>
            {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        <form method="POST" action="{{ url_for('index', lang=lang) }}">
            {{ form.hidden_tag() }}
            <p>{{ form.name.label }}<br>{{ form.name(size=30) }}</p>
            <p>{{ form.email.label }}<br>{{ form.email(size=30) }}</p>
            <p>{{ form.message.label }}<br>{{ form.message(rows=5, cols=30) }}</p>
            <p>{{ form.submit() }}</p>
        </form>
    </section>
{% endblock %}